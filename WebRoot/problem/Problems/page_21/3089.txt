</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The <i>National Transportation Communications for ITS Protocol</i> (NTCIP) for communicating with highway signs with dynamic messages describes the messages using <i>Markup Language for Transportation Information</i> (MULTI). A MULTI string consists of text to be displayed together with embedded tags which describe formatting of the text and included dynamic elements. Tags begin with the open bracket (&lsquo;[&rsquo;) character and end with the close bracket (&lsquo;]&rsquo;) character. If an open bracket character is to appear in the text, it is represented as two open bracket characters. Similarly, if a close bracket character is to appear in the text, it is represented as two close bracket characters. This problem is concerned with formatting for character cell displays, which are rectangular arrays of character cells each of which can display a single character.</p><p>The tags to be supported for this problem are:</p><table border="1" style="border-collapse: collapse" bordercolor="#000000" cellpadding="2"><tr><td><b>Tag</b></td><td><b>Description</b></td></tr><tr><td valign="top"><b><code>[nl]</code></b></td><td>Start a new row of the array</td></tr><tr><td valign="top"><b><code>[sc&lt;<i>digit</i>&gt;]</code></b></td><td>Insert <b><code>&lt;<i>digit</i>&gt;</code></b> blank character cells between each pair of text characters in the following string until changed.</td></tr><tr><td valign="top"><b><code>[/sc]</code></b></td><td>Set inter-character spacing to zero (equivalent to <b><code>[sc0]</code></b>).</td></tr><tr><td valign="top"><b><code>[jl2]</code></b></td><td>Set left justified text (the first character of the text is the leftmost character of the line).</td></tr><tr><td valign="top"><b><code>[jl3]</code></b></td><td>Set center justified text (the number of character positions before and after the text on the line is the same or the number after is one more than the number before).</td></tr><tr><td valign="top"><b><code>[jl4]</code></b></td><td>Set right justified text (the final character of the string is the rightmost character on the line).</td></tr><tr><td valign="top"><b><code>[jl5]</code></b></td><td>Set fully justified text (an equal number of blank character spaces, as large as possible for the line length, is placed between each pair of characters in the text; the resulting string is centered in the line as for centered text).</td></tr></table><p>For example, on a 24 character line:</p><table border="1" style="border-collapse: collapse" bordercolor="#000000" cellpadding="2"><tr><td><b>Format String</b></td><td><b>Generated Output</b></td></tr><tr><td><b><code>[jl2]MESSAGE</code></b></td><td><code>MESSAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></td></tr><tr><td><b><code>[jl3]MESSAGE</code></b></td><td><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></td></tr><tr><td><b><code>[jl4]MESSAGE</code></b></td><td><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span lang="en-us">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></code><span lang="en-us"><code>&nbsp;</code></span><code>MESSAGE</code></td></tr><tr><td><b><code>[jl2][sc2]MESSAGE</code></b></td><td><code>M&nbsp;&nbsp;E&nbsp;&nbsp;S&nbsp;&nbsp;S&nbsp;&nbsp;A&nbsp;&nbsp;G&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></td></tr><tr><td><b><code>[jl5]MESSAGE</code></b></td><td><code>&nbsp;&nbsp;M&nbsp;&nbsp;E&nbsp;&nbsp;S&nbsp;&nbsp;S&nbsp;&nbsp;A&nbsp;&nbsp;G&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;</code></td></tr><tr><td><b><code>[jl2]THIS[jl3]IS A[jl4]MESSAGE</code></b></td><td><code>THIS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS A&nbsp;&nbsp;&nbsp;MESSAGE</code></td></tr></table><p>Letters within tags are case-insensitive. That is <code>[nl] = [NL] = [Nl] = [nL]</code>.</p><p>The default justification at the beginning of a message is left justification and the default character spacing is 0.</p><p>Justification and character spacing are maintained across <code>[nl]</code> tags.</p><p>The <code>[jl2]</code> and <code>[jl5]</code> tags may only be used before any text has been output on a line. Otherwise it is an error (<b>TAG CONFLICT</b>).</p><p>Once <code>[jl5]</code> text has been output on a line, no other justification tag may be set on that line. Otherwise it is an error (<b>TAG CONFLICT</b>).</p><p>The <code>[jl3]</code> tag may not be used after right justified text (<code>[jl4]</code>) has been output on a line. Otherwise it is an error (<b>TAG CONFLICT</b>).</p><p>A justification tag <code>[jl?]</code> with the same value as the current value does not cause a <b>TAG CONFLICT</b> error.</p><p>Extra character spacing specified by the <code>[sc?]</code> tag is ignored on lines with fully justified text. The full justification rules determine the extra spaces.</p><p>If too many characters are required on a line or too many lines are required in a message, it is an error (<b>TOO BIG</b>). A <code>[nl]</code> tag does not begin a new line unless followed by text output.</p><p>If left justified text and center justified text appear on the same line, there must be at least one blank character cell between the last character of left justified text and the first character of center justified text. Otherwise it is an error (<b>TOO BIG</b>).</p><p>If center justified text and right justified text appear on the same line, there must be at least one blank character cell between the last character of center justified text and the first character of right justified text. Otherwise it is an error (<b>TOO BIG</b>).</p><p>If left justified text and right justified text appear on the same line, there must be at least one blank character cell between the last character of left justified text and the first character of right justified text. Otherwise it is an error (<b>TOO BIG</b>).</p><p>The only tags allowed in a message are the seven tags listed above otherwise it is an error (<b>BAD TAG</b>). A malformed tag or an unmatched single open or closed bracket is a <b>BAD TAG</b> error.</p><p>For this problem you will write a program which takes as input the dimensions of the character cell array and a MULTI string and either outputs an error string or a correctly formatted message.</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The first line of input contains a single integer <i><b>N</b></i> (1 &le; <i><b>N</b></i> &le; 100), which is the number of datasets that follow. Each dataset consists of a single line containing an integer <i><b>R</b></i> (1 &le; <i><b>R</b></i> &le; 25), a blank, an integer <i><b>C</b></i> (1 &le; <i><b>C</b></i> &le; 80), a blank, and the remainder of the line is a <i><b>MULTI-Text</b></i> string. <i><b>R</b></i> is the number of rows in the character cell array, <i><b>C</b></i> is the number of columns in the character cell array, and the <i><b>MULTI-Text</b></i> is the text to be formatted.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each dataset, output the dataset number on a line by itself, followed by one of the error strings (<b>TAG CONFLICT</b>, <b>TOO BIG</b>, <b>BAD TAG</b>) on a line by itself in the case of an error, or, <i><b>R</b></i> lines each of which has exactly <i><b>C</b></i> characters (other than terminating newlines) representing the formatted message using space characters for empty character cells. The last line of output for a dataset result should be a single blank line.</p></div><p class="pst">Sample Input</p><pre class="sio">7
4 24 [jl2]MESSAGE[nl][jl3]MESSAGE[nl][jl4]MESSAGE
2 24 This[jl3]is a[jl4]message
2 24 This is a very long message which will not fit
4 24 This[nl]message[nl]has[nl]too[nl]many[nl]lines
2 32 [jl3]This message has a [[ and a ]]
2 32 This is a bad tag[xy34]
2 32 [jl3]This message [jl5] has a tag conflict.</pre><p class="pst">Sample Output</p><pre class="sio">1
MESSAGE                  
        MESSAGE          
                  MESSAGE
                         
2
This      is a    message
                         

3
TOO BIG

4
TOO BIG

5
   This message has a [ and a ]  
                                 

6
BAD TAG

7
TAG CONFLICT</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p><b>Note</b>: For ease in grading, a dataset that contains an error will only contain one type of error.</p><p>Copy the sample output to a text editor to see the exact output format.</p></div><p class="pst">