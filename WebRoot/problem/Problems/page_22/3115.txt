</p><div class="ptx" lang="en-US"><span lang="en-us"><p>Paul works for a big company called Abacus Computers and Maintenance (ACM). His job is to provide maintenance of computers for clients of ACM, located in different parts of the country. For this reason, Paul normally spends a good number of hours each week on flights. Obviously, Paul always takes along his laptop, so that he can work on many tasks related to his job while flying.</p><p>As batteries of laptops generally won&rsquo;t last long, Paul has studied alternatives to increase the duration time of the battery during flights. He found that modern processors can operate at different frequency levels, offering a compromise between performance and energy consumption. Paul&rsquo;s initial idea was to simply configure his laptop at the lowest frequency. However, he noted that it was not that useful, since tasks executed very slowly on the laptop, and there wasn&rsquo;t enough time to execute all the tasks, so that the energy remaining in the battery would be unused.</p><p>Paul noted, however, that the effect of frequency levels on performances varies from one application to another, depending on whether they are limited by memory, CPU or I/O. Additionally, as modern processors permit the frequency level to be modified by software, Paul plans to use this mechanism to increase the usage time of the battery of his laptop, while still maintaining a reasonable performance. In order to consider both energy and performance, Paul decided to use a metric already well-known, called <i>Energy &times; Delay Product</i> (EDP).</p><p>Paul has a list of programs that must be executed sequentially, and all the information of time and energy needed to execute each program at each frequency level, along with the information of how much energy is spent to make processor change frequency. However, to test his new idea, Paul still has a problem: like most system administrators, he doesn&rsquo;t like programming. He is asking for your help, for you are a great friend of his and an expert in algorithms and programming, to determine the frequency level at which each of his programs should be executed so as to minimize the total EDP.</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The input contains several test cases. The first line of a test case contains four integers <i>F</i>, <i>P</i>, <i>E</i>, and <i>A</i>, identifying respectively the number of frequency levels supported by the processor of Paul&rsquo;s laptop (1 &le; <i>F</i> &le; 20), the number of programs to be executed <i>sequentially</i> (1 &le; <i>P</i> &le; 5000), the energy needed, in Joules, to change between any two frequency levels (1 &le; <i>E</i> &le; 100) and the time (in ms) to change between any two frequency levels (1 &le; <i>A</i> &le; 100). The frequency levels are identified by integers from 1 to <i>F</i>, and the programs are identified by integers from 1 to <i>P</i>.</p><p>The following <i>P</i> &times; <i>F</i> lines describe the programs, with <i>F</i> lines for each program (the first <i>F</i> lines correspond to program 1, the next <i>F</i> lines correspond to program 2, and so on). The <i>f</i>-th line corresponding to program <i>p</i> contains two integers <i>E<sub>p</sub></i><sub>, <i>f</i></sub> and <i>A<sub>p</sub></i><sub>, <i>f</i></sub>, representing respectively the quantity of energy (in Joules) and time (in ms) to execute program <i>p</i> at frequency level <i>f</i> (1 &le; <i>E<sub>p</sub></i><sub>, <i>f</i></sub>  &le; 1000 and 1 &le; <i>A<sub>p</sub></i><sub>, <i>f</i></sub> &le; 1000). At the beginning of each test case the processor is at frequency level 1. The end of the input is indicated by <i>F</i> = <i>P</i> = <i>E</i> = <i>A</i> = 0.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each test case, your program should produce one line of output, containing the minimum EDP to execute sequentially the set of programs from 1 to <i>P</i> (that is, in the order they appear in the input).</div><p class="pst">Sample Input</p><pre class="sio">2 3 10 10
50 120
100 90
500 600
600 500
400 1000
500 700
3 3 2 5
7 10
8 5
15 4
12 4
11 5
12 4
7 10
8 5
15 4
0 0 0 0</pre><p class="pst">Sample Output</p><pre class="sio">656100
145</pre><p class="pst">