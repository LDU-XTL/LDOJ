</p><div class="ptx" lang="en-US"><span lang="en-us"><p>MegaCheckers is a board game for two players, very similar to the known game of Checkers. The board is rectangular, with <i>N</i> rows and <i>M</i> columns of small squares arranged in an <i>N</i> &times; <i>M</i> grid. The small squares are alternatingly colored with a light color and a dark color, in the usual standard of a checkers board. The squares of dark color are calls &ldquo;homes&rdquo; (note however that, for visualization reasons, the figures below show homes as white squares).</p><p>At the beginning of the game, each player has a certain number of pieces, placed in homes closest to the edge of the board the player chooses (the players choose opposite edges). During the game, the pieces can only occupy the homes of the board.</p><p>One of the moves of the game is to &ldquo;capture&rdquo; an opponent&rsquo;s piece, jumping over it, diagonally, to an adjacent home beyond the piece, which should be empty. The opponent&rsquo;s piece is then removed from the board. The three homes involved in the capture (the initial home of your piece, the home that holds the opponent&rsquo;s piece and the empty home, where your piece will be after the play) must be diagonally aligned and diagonally adjacent, as in the figure below.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0" width="500" height="300"><tr><td align="center" width="50%" valign="middle"><img src="images/3116_1.gif"></td><td align="center" width="50%" valign="middle"><img src="images/3116_2.gif"></td></tr><tr><td align="center" width="50%">Simple capture</td><td align="center" width="50%">Multiple capture</td></tr></table></div><p>In MegaCheckers a piece can capture the opponent&rsquo;s pieces jumping diagonally forward or backward (note that, in the majority of existent variants of the game of checkers, a piece can only capture opponent pieces jumping forward). You can also trigger a multiple capture, with just one piece, jumping successively to empty homes over opponent pieces. In a multiple capture, your piece can change direction, jumping in one direction and later in another one. You can capture only one piece each jump, but can capture several pieces with successive jumps. You can&rsquo;t jump over a piece of yours, or jump over the same opponent piece more than once.</p><p>The dimensions of the board and a description of the current state of a game are given. It&rsquo;s your turn to play and you should determine of maximum number of your opponent&rsquo;s pieces that can be captured in one capture move.</p></span></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The input contains several test cases. The first line of a test case contains two integers <i>N</i> and <i>M</i> indicating respectively the number of rows and the number of columns of the board (3 &le; <i>N</i> &le; 20, 3 &le; <i>M</i> &le; 20 and <i>N</i> &times; <i>M</i> &le; 200). The leftmost square of the board at the edge closest to the player is a home. The second line contains the description of the state of the game. Each description consists of <i>ceiling</i>((<i>N</i> &times; <i>M</i>) &frasl; 2) integers, separated by a space, corresponding to the homes of the board, which are numbered from 1 to <i>ceiling</i>((<i>N</i> &times; <i>M</i>) &frasl; 2), from left to right, from the edge closest to the player to the edge closest to his opponent. In the description of the state of the game, &lsquo;<code>1</code>&rsquo; represents a home with a piece of yours, and &lsquo;<code>2</code>&rsquo; represents a home with a piece of your opponent&rsquo;s. There are at most <i>floor</i>((<i>N</i> &times; <i>M</i>) &frasl; 4) pieces of each player on the board. The end of the input is indicated by <i>N</i> = <i>M</i> = 0.</p><div align="center"><table border="0" cellpadding="0" cellspacing="0" width="500" height="300"><tr><td align="center" valign="middle" width="50%"><img src="images/3116_3.png"></td><td align="center" valign="middle" width="50%"><img src="images/3116_4.gif"></td></tr><tr><td align="center" width="50%">(a)</td><td align="center" width="50%">(b)</td></tr></table></div><p align="center">Figure 1: Numeration of homes on (a) board of dimensions 8 &times; 8 and on (b) board of dimensions 5 &times; 3.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><span lang="en-us"><p>For each test case, your program should produce one line of output, containing an integer indicating the largest number of pieces of your opponent&rsquo;s that can be captured in one move.</p></span></div><p class="pst">Sample Input</p><pre class="sio">3 3
2 1 2 0 1
5 3
1 0 2 1 0 2 0 0
8 8
2 2 2 2 0 0 0 0 2 2 2 2 0 0 0 0 2 2 2 2 0 0 0 0 2 2 2 2 0 1 0 0
0 0</pre><p class="pst">Sample Output</p><pre class="sio">1
2
7</pre><p class="pst">