</p><div class="ptx" lang="en-US"><p>In calculating the outer product of vectors, existence of constraints usually makes it that not all the components of the product are independent of the others. For example, the outer product of two two-dimensional vectors <b><i>A</i></b> = (<i>a</i><sub>1</sub>, <i>a</i><sub>2</sub>) and <b><i>B</i></b> = (<i>b</i><sub>1</sub>, <i>b</i><sub>2</sub>), <b><i>C</i></b> = <b><i>A</i></b> &times; <b><i>B</i></b> = (<i>c</i><sub>11</sub>, <i>c</i><sub>12</sub>, <i>c</i><sub>21</sub>, <i>c</i><sub>22</sub>). If we set <i>c</i><sub>12</sub> = <i>c</i><sub>21</sub>, then only three of the four components of <b><i>C</i></b> is independent, or <b><i>C</i></b> has three free dimensions.</p><p>Now we have <i>k</i> <i>n</i>-dimensional vectors <b><i>A</i></b><sub>1</sub>, <b><i>A</i></b><sub>2</sub>, &hellip;, <i><b>A</b><sub>k</sub></i>. The product of them is a vector of <i>n<sup>k</sup></i> components <b><i>Z</i></b> = (<i>z<sub>&alpha;</sub></i>) where <i>&alpha;</i> enumerates all possible subscripts <i>i</i><sub>1</sub><i>i</i><sub>2</sub>&hellip;<i>i<sub>k</sub></i> (1 &le; <i>i<sub>j</sub></i> &le; <i>n</i> for all <i>j</i> s.t. 1 &le; <i>j</i> &le; <i>k</i>). We can then apply a rule of constraint of the form <i>s</i><sub>1</sub><i>s</i><sub>2</sub>&hellip;<i>s<sub>k</sub></i>=<i>t</i><sub>1</sub><i>t</i><sub>2</sub>&hellip;<i>t<sub>k</sub></i> to the subscripts. Here <i>s</i><sub>1</sub><i>s</i><sub>2</sub>&hellip;<i>s<sub>k</sub></i> and <i>t</i><sub>1</sub><i>t</i><sub>2</sub>&hellip;<i>t<sub>k</sub></i> are two strings consisting of the same set of lowercase letters. A letter appearing in one string will also appear in the other one and it can have multiple occurrences in a string. When a rule is applied, the letters in it are replaced by arbitrary integers between 1 and <i>n</i> (inclusive) provided that the same letters are replaced by the same integers and different letters are replaced by different integers. If a resulted string after replacements is <i>p</i><sub>1</sub><i>p</i><sub>2</sub>&hellip;<i>p<sub>k</sub></i>=<i>q</i><sub>1</sub><i>q</i><sub>2</sub>&hellip;<i>q<sub>k</sub></i>, let <i>&alpha;</i> be <i>p</i><sub>1</sub><i>p</i><sub>2</sub>&hellip;<i>p<sub>k</sub></i> and <i>&beta;</i> be <i>q</i><sub>1</sub><i>q</i><sub>2</sub>&hellip;<i>q<sub>k</sub></i>, then we set <i>z<sub>&alpha;</sub></i> = <i>z<sub>&beta;</sub></i>. Given the number of vectors and their dimensions and a rule of constraint, you are required to compute the number of free dimensions of the product of the vectors.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input contains several test cases. Each test case consists of two lines followed by a blank one. On the first line there are two integers which are <i>n</i> and <i>k</i> in the order they appear. On the second line is a rule of constraint. Two zeroes on a separate line follow the last test case.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each test case, output one line containing the number of free dimensions of the product of vectors.</p></div><p class="pst">Sample Input</p><pre class="sio">2 2
ij=ji

3 3
iij=jii

0 0</pre><p class="pst">Sample Output</p><pre class="sio">3
21</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>In the second test case in the sample input, the rule <i>iij</i>=<i>jii</i> represents the constraints <i>z</i><sub>112</sub> = <i>z</i><sub>211</sub>, <i>z</i><sub>113</sub> = <i>z</i><sub>311</sub>, <i>z</i><sub>221</sub> = <i>z</i><sub>122</sub>, <i>z</i><sub>223</sub> = <i>z</i><sub>322</sub>, <i>z</i><sub>331</sub> = <i>z</i><sub>133</sub> and <i>z</i><sub>332</sub> = <i>z</i><sub>233</sub>.</p><p>You can safely assume that all calculations can be done with 64-bit integers.</p></div><p class="pst">