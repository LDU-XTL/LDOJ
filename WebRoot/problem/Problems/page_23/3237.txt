</p><div class="ptx" lang="en-US"><p>You are given a tree with <i>N</i> nodes. The tree&rsquo;s nodes are numbered 1 through <i>N</i> and its edges are numbered 1 through <i>N</i> &minus; 1. Each edge is associated with a weight. Then you are to execute a series of instructions on the tree. The instructions can be one of the following forms:</p><table border="1" style="border-collapse: collapse"><tr><td><code>CHANGE</code> <i>i</i> <i>v</i></td><td>Change the weight of the <i>i</i>th edge to <i>v</i></td></tr><tr><td><code>NEGATE</code> <i>a</i> <i>b</i></td><td>Negate the weight of every edge on the path from <i>a</i> to <i>b</i></td></tr><tr><td><code>QUERY</code> <i>a</i> <i>b</i></td><td>Find the maximum weight of edges on the path from <i>a</i> to <i>b</i></td></tr></table></div><p class="pst">Input</p><div class="ptx" lang="en-US"><span lang="en-us"><p>The input contains multiple test cases. The first line of input contains an integer <i>t</i> (<i>t</i> &le; 20), the number of test cases. Then follow the test cases.</p><p>Each test case is preceded by an empty line. The first nonempty line of its contains <i>N</i> (<i>N</i> &le; 10,000). The next <i>N</i> &minus; 1 lines each contains three integers <i>a</i>, <i>b</i> and c, describing an edge connecting nodes <i>a</i> and <i>b</i> with weight <i>c</i>. The edges are numbered in the order they appear in the input. Below them are the instructions, each sticking to the specification above. A lines with the word &ldquo;<code>DONE</code>&rdquo; ends the test case.</p></span></div><p class="pst">Output</p><div class="ptx" lang="en-US"><span lang="en-us"><p>For each &ldquo;<code>QUERY</code>&rdquo; instruction, output the result on a separate line.</p></span></div><p class="pst">Sample Input</p><pre class="sio">1

3
1 2 1
2 3 2
QUERY 1 2
CHANGE 1 3
QUERY 1 2
DONE</pre><p class="pst">Sample Output</p><pre class="sio">1
3</pre><p class="pst">