</p><div class="ptx" lang="en-US"><p>Frank is a portfolio manager of a closed-end fund for <i>Advanced Commercial Markets</i> (<i>ACM</i>). Fund collects money (cash) from individual investors for a certain period of time and invests cash into various securities in accordance with fund’s investment strategy. At the end of the period all assets are sold out and cash is distributed among individual investors of the fund proportionally to their share of original investment.</p><p>Frank manages equity fund that invests money into stock market. His strategy is explained below.</p><p>Frank’s fund has collected <i>c</i> US Dollars (USD) from individual investors to manage them for <i>m</i> days. Management is performed on a day by day basis. Frank has selected <i>n</i> stocks to invest into. Depending on the overall price range and availability of each stock, a <i>lot size</i> was chosen for each stock — the number of shares of the stock Frank can buy or sell per day without affecting the market too much by his trades. So, if the price of the stock is <i>p<sub>i</sub></i> USD per share and the lot size of the corresponding stock is <i>s<sub>i</sub></i>, then Frank can spend <i>p<sub>i</sub>s<sub>i</sub></i> USD to buy one lot of the corresponding stock for his fund if the fund has enough cash left, thus decreasing available cash in the fund. This trade is completely performed in one day.</p><p>When price of the stock changes to <i>p</i>′<sub style="margin-left: -0.5ex;"><i>i</i></sub> later, then Frank can sell this lot for <i>p</i>′<i><sub style="margin-left: -0.5ex;">i</sub>s<sub>i</sub></i> USD, thus increasing available cash for further trading. This trade is also completely performed in one day. All lots of stocks that are held by the fund must be sold by the end of the fund’s period, so that at the end (like at the beginning) the fund is holding only cash.</p><p>Each stock has its own volatility and risks, so to minimize the overall risk of the fund, for each stock there is the maximum number of lots <i>k<sub>i</sub></i> that can be held by the fund at any given day. There is also the overall limit <i>k</i> on the number of lots of all stocks that the fund can hold at any given day.</p><p>Any trade to buy or sell one lot of stock completely occupies Frank’s day, and thus he can perform at most one such trade per day. Frank is not allowed to buy partial lots if there is not enough cash in the fund for a whole lot at the time of purchase.</p><p>Now, when fund’s period has ended, Frank wants to know what is the maximum profit he could have made with this strategy having known the prices of each stock in advance. Your task is to write a program to find it out.</p><p>It is assumed that there is a single price for each stock for each day that Frank could have bought or sold shares of the stock at. Any overheads such as fees and commissions are ignored, and thus cash spent to buy or gained on a sell of one lot of stock is exactly equal to its price on this day multiplied by the number of shares in a lot.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains four numbers — <i>c</i>, <i>m</i>, <i>n</i>, and <i>k</i>. Here <i>c</i> (0.01 ≤ <i>c</i> ≤ <nobr>100 000 000.00</nobr>) is the amount of cash collected from individual investors up to a cent (up to two digits after decimal point); <i>m</i> (1 ≤ <i>m</i> ≤ 100) is the number of days in the fund’s lifetime; <i>n</i> (1 ≤ <i>n</i> ≤ 8) is the number of stocks selected by Frank for trading; <i>k</i> (1 ≤ <i>k</i> ≤ 8) is the overall limit on the number of lots the fund can hold at any time.</p><p>The following 2<i>n</i> lines describe stocks and their prices with two lines per stock.</p><p>The first line for each stock contains the stock name followed by two integer numbers <i>s<sub>i</sub></i> and <i>k<sub>i</sub></i>. Here <i>s<sub>i</sub></i> (1 ≤ <i>s<sub>i</sub></i> ≤ <nobr>1 000 000</nobr>) is the lot size of the given stock, and <i>k<sub>i</sub></i> (1 ≤ <i>k<sub>i</sub></i> ≤ <i>k</i>) is the number of lots of this stock the fund can hold at any time. Stock name consists of 1 to 5 capital Latin letters from “A” to “Z”. All stock names in the input file are distinct.</p><p>The second line for each stock contains <i>m</i> decimal numbers separated by spaces that denote prices of the corresponding stock for each day in the fund’s lifetime. Stock prices are in range from 0.01 to 999.99 (inclusive) given up to a cent (up to two digits after decimal point).</p><p>Cash and prices in the input file are formatted as a string of decimal digits, optionally followed by a dot with one or two digits after a dot.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>Write to the output file <i>m</i> + 1 lines.</p><p>On the first line write a single decimal number — the precise value for the maximal amount of cash that can be collected in the fund by the end of its period. The answer will not exceed <nobr>1 000 000 000.00</nobr>. Cash must be formatted as a string of decimal digits, optionally followed by a dot with one or two digits after a dot.</p><p>On the following <i>m</i> lines write the description of Frank’s actions for each day that he should have made in order to realize this profit. Write <tt>BUY</tt> followed by a space and a stock name for buying a stock. Write <tt>SELL</tt> followed by a space and a stock name for selling a stock. Write <tt>HOLD</tt> if nothing should have been done on that day.</p></div><p class="pst">Sample Input</p><pre class="sio">144624.00 9 5 3
IBM 500 3
97.27 98.31 97.42 98.9 100.07 98.89 98.65 99.34 100.82
GOOG 100 1
467.59 483.26 487.19 483.58 485.5 489.46 499.72 505 504.28
JAVA 1000 2
5.54 5.69 5.6 5.65 5.73 6 6.14 6.06 6.06
MSFT 250 1
29.86 29.81 29.64 29.93 29.96 29.66 30.7 31.21 31.16
ORCL 300 3
17.51 17.68 17.64 17.86 17.82 17.77 17.39 17.5 17.3</pre><p class="pst">Sample Output</p><pre class="sio">151205.00
BUY GOOG
BUY IBM
BUY IBM
HOLD
SELL IBM
BUY MSFT
SELL MSFT
SELL GOOG
SELL IBM</pre><p class="pst">