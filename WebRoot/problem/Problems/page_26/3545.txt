</p><div class="ptx" lang="en-US"><img align="right" style="margin-left: 10px; margin-bottom: 10px;" src="images/3545_1.gif"> <p>When scientists re-discovered ancient Mayan cities, they found many texts, written in unknown script. An example of the script is shown on the right, where the name of <i>K’ak’-u-pakal</i>, a military leader and priest in ancient Mayan city of Chichén Itzá, is written (see A. W. Voss, H. J. Kremer, <i>K’ak’-u-pakal, Hun-pik-tok’ and the Kokom</i> for details). This hieroglyph can be found in many sites of the city.</p><p>Mayan hieroglyphs are not hieroglyphs in proper sense, but compositions of separate glyphs. All known glyphs (there is about one thousand of them) are indexed with numbers from 1 to 9999. A special language for encoding glyphs relative positions made it possible to write any hieroglyph in plain text. For example the above <i>K’ak’-u-pakal</i> hieroglyph is encoded as “<tt>((669:604).(586:(27:[(534.534)])))</tt>”.</p><p>Here is the formal grammar of the language (adapted for the contest):</p><table align="center"><tr><td align="right">‹inscription›</td><td style="width: 3em;" align="center">→</td><td align="left">‹glyph id› | ‘<tt>(</tt>’ ‹block› ‘<tt>.</tt>’ ‹horizontal group› ‘<tt>)</tt>’ | ‘<tt>(</tt>’ ‹block› ‘<tt>:</tt>’ ‹vertical group› ‘<tt>)</tt>’ </td></tr><tr><td align="right">‹horizontal group›</td><td style="width: 3em;" align="center">→</td><td align="left">‹block› [‘<tt>.</tt>’ ‹horizontal group›]</td></tr><tr><td align="right">‹vertical group›</td><td style="width: 3em;" align="center">→</td><td align="left">‹block› [‘<tt>:</tt>’ ‹vertical group›]</td></tr><tr><td align="right">‹block›</td><td style="width: 3em;" align="center">→</td><td align="left">‹inscription› | ‘<tt>[</tt>’ ‹inscription› ‘<tt>]</tt>’</td></tr></table><p>The hieroglyph encoding describes a process of the hieroglyph composition. Glyphs are combined horizontally or vertically (using ‘<tt>.</tt>’ or ‘<tt>:</tt>’) into blocks, which in turn are combined into larger and larger blocks, until the necessary configuration is achieved.</p><p>It took a hundred years to decipher Mayan hieroglyphs and convert them into plain text, but we hope that you can create a program for the backward conversion (text to hieroglyph layout) much quicker.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input file contains a space-free text string (255 symbols at most), containing Mayan hieroglyph encoded in plain text form.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>Output text, composed of characters ‘<tt>+</tt>’, ‘<tt>-</tt>’, ‘<tt>|</tt>’, ‘<tt> </tt>’ (ASCII codes 43, 45, 124, 32), ‘<tt>0</tt>’..‘<tt>9</tt>’ and line feeds. All blocks of a group should have exactly the same size, except the block with square braces around it (there will be one such block per group at most) which should be exactly two times wider (or higher if the group is vertical). The glyph id (with one leading and one trailing space) should be placed at the upper left corner of the block. The output should be as short as possible. It’s guaranteed that for each test there exists a proper layout, which has <nobr>100 000</nobr> bytes at most.</p></div><p class="pst">Sample Input</p><pre class="sio">((669:604).(586:(27:[(534.534)])))</pre><p class="pst">Sample Output</p><pre class="sio">+-----------+-----------+
| 669       | 586       |
|           |           |
|           |           |
|           |           |
|           |           |
+-----------+-----------+
| 604       | 27        |
|           +-----+-----+
|           | 534 | 534 |
|           |     |     |
|           |     |     |
+-----------+-----+-----+</pre><p class="pst">