</p><div class="ptx" lang="en-US"><p>There are many modifications of the famous Rubic’s Cube puzzle. One of those, called the Magic Pyramid, is based on a tetrahedron instead of the original cube. Faces of the tetrahedron are labeled with the Latin letters <b>X</b>, <b>U</b>, <b>V</b>, and <b>W</b>. Each face is divided into 9 equilateral triangles numbered from 1 to 36, as shown on Figure 1. To assemble the tetrahedron, the big triangle has to be folded down along the internal thick lines and the matching halves of the external thick lines have to be glued together.</p><p>Each of the small triangles is painted into one of four distinct colors that we label with the Latin letters <b>a</b>, <b>b</b>, <b>c</b>, and <b>d</b>. There are exactly 9 triangles of each of the four colors.</p><div align="center"><img src="images/3564_1.gif"><br>• Fig. 1</div><p>We can transform the tetrahedron using the operation of ”<i>rotate a face</i>”. To perform this operation, we choose a face of the pyramid and orient the pyramid so that the chosen face is towards us. Then we determine the direction of the rotation (clockwise or counter-clockwise). Finally, we turn the part of the tetrahedron closest to the chosen face and having the thickness of 1/3 of the height of the tetrahedron by 120 degrees in the chosen direction, leaving the remaining part of the tetrahedron unmoved. Figure 2 illustrates the effect of rotating the face <b>U</b> in clockwise direction.</p><p>In addition to rotating the faces, we can also apply the operation of ”<i>magic re-paint</i>”. This operation is defined by a permutation (<b>p<sub>1</sub></b>, …, <b>p<sub>36</sub></b>) of the integers 1 to 36. The effect of the operation is that the triangle currently in position <b>i</b> (according to the numbering given on Figure 1) is re-painted into the color of the triangle currently in position <b>p<sub>i</sub></b> (according to the same numbering). All 36 triangles are re-painted simultaneously.</p><div align="center"><img src="images/3564_2.gif"><br>• Fig. 2</div><p>The puzzle is solved if, after applying a number of operations ”rotate a face” and/or ”magic re-paint” all triangles on each face of the tetrahedron have the same color.</p><p>Write a program to solve the Magic Pyramid puzzle using the minimal possible number of moves. You may assume that all the test cases are solvable in 9 or less moves.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The first line of the input contains 36 letters ’<tt>a</tt>’ … ’<tt>d</tt>’. The letter on the position <b>i</b> denotes the initial color of the triangle number <b>i</b>. It is known that each of the four letters occurs exactly 9 times on the first line of the file.</p><p>The second line of the file contains 36 distinct integers 1…36 that describe the ”magic re-paint” operation. The <b>i</b><sup>th</sup> integer on this line is the member <b>p<sub>i</sub></b> of the permutation that defines the operation.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>The first and only line of the output should contain a string of characters ’<tt>X</tt>’, ’<tt>U</tt>’, ’<tt>V</tt>’, ’<tt>W</tt>’, ’<tt>x</tt>’, ’<tt>u</tt>’, ’<tt>v</tt>’, ’<tt>w</tt>’, and ’<tt>*</tt>’. The <b>i</b><sup>th</sup> character should describe the <b>i</b><sup>th</sup> move in the solution of the puzzle. Each operation ”rotate a face” is given as the label of the corresponding face, with lowercase letter denoting a turn in the clockwise and uppercase letter a turn in the counter-clockwise direction. The operation ”magic re-paint” is given as the character ’<tt>*</tt>’.</p><p>If there are several solutions with the minimal number of moves, output any one of them. If the puzzle can be solved in no moves at all, output an empty line into the output.</p></div><p class="pst">Sample Input</p><pre class="sio">ddddcccccabbbbbdcaabbbddacccaabddaaa
36 35 34 33 32 31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1
</pre><p class="pst">Sample Output</p><pre class="sio">*U</pre><p class="pst">Hint</p><div class="ptx" lang="en-US"><p>Explanation of the example: Figure 3 shows the initial coloring of the tetrahedron, and Figures 4 and 5 show the results of each operation. The colors of the triangles are given by the following patterns:</p><img align="left" style="margin-right: 10px; margin-top: 10px;" src="images/3564_6.png"><table align="center"><tr><td><img src="images/3564_3.gif"></td><td>• Fig. 3</td></tr><tr><td><img src="images/3564_4.gif"></td><td>• Fig. 4</td></tr><tr><td><img src="images/3564_5.gif"></td><td>• Fig. 5</td></tr></table></div><p class="pst">