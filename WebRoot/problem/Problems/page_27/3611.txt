</p><div class="ptx" lang="en-US"><div><p>In graph theory, a <i>matching M</i> of a graph <i>G</i> = (<i>V</i>,<i>E</i>) is defined as a pairwise disjoint subset of <i>E</i>. Put alternatively, a matching <i>M</i> of <i>G</i> is a subset of <i>E</i> such that each vertex covered by <i>M</i> is incident to exactly one edge in <i>M</i>. A <i>perfect matching</i> <i>M</i> of <i>G</i> is a matching that covers all vertices of <i>G</i>.</p><p>Extending the definition of a matching, the concept of <i>b-matching</i> is based on a graph <i>G</i> where each vertex <i>v</i> is associated with a non-negative integral balance <i>b</i>(<i>v</i>) and each edge <i>e</i> with a non-negative integral capacity <i>u</i>(<i>e</i>). A <i>b</i>-matching <i>M</i> of <i>G</i> is defined as an assignment of a non-negative integral bidirected flow <i>x</i>(<i>e</i>) &le; <i>u</i>(<i>e</i>) to each edge <i>e</i>. A <i>perfect b-matching</i> is a <i>b</i>-matching where for each vertex <i>v</i>, </p><center><img src="formula?tex=%5Csum_%7Be%5Cin+E%28v%29%7Dx%28e%29%3Db%28v%29" alt="\sum_{e\in E(v)}x(e)=b(v)" align="absmiddle">,</center><p>in which <i>E</i>(<i>v</i>) denotes the set of all edges incident to <i>v</i>. Intuitively speaking, a perfect <i>b</i>-matching is a generalized perfect matching that allows each vertex to be incident to multiple edges and each edge to be used multiple times. A <i>perfect fractional b-matching</i> is a relaxation of a perfect <i>b</i>-matching. A perfect <i>b</i>-matching demands the integrality of the flows, whereas a perfect fractional <i>b</i>-matching permits that they take fractional values. Associating a weight <i>c</i>(<i>e</i>) with each edge <i>e</i> of <i>G</i>, the weight of a perfect fractional <i>b</i>-matching is defined as</p><center><img src="formula?tex=%5Csum_%7Be%5Cin+E%7Dc%28e%29x%28e%29" alt="\sum_{e\in E}c(e)x(e)" align="absmiddle">.</center><p>A minimum weighted perfect fractional <i>b</i>-matching is defined as the perfect fractional <i>b</i>-matching with the minimum weight. </p><p>Given a capacitated, weighted graph with a balance constraint on each vertex, find a minimum weighted perfect fractional <i>b</i>-matching.ã€€</p></div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><div><p>The first line contains two integers <i>m</i> and <i>n</i>, (1 &le; <i>m </i>&le; 1000, 1 &le; <i>n </i>&le; 100), the numbers of edges and vertices of the graph. The vertices are numbered 1 through <i>n</i>. </p><p>The next <i>m</i> lines each contain four integers <i>x</i>, <i>y</i>, <i>u</i>(<i>e</i>) and <i>c</i>(<i>e</i>) (1 &le; <i>x</i>, <i>y</i> &le; <i>n</i>, 1 &le; <i>u</i>(<i>e</i>) &le; 200, 1 &le; <i>c</i>(<i>e</i>) &le; 200) describing an edge <i>e</i>, where <i>x</i> and <i>y</i> are the endpoint<i>s</i> of <i>e</i>, and <i>u</i>(<i>e</i>) and <i>c</i>(<i>e</i>) are the capacity and the weight of <i>e</i>, respectively. </p><p>The last <i>n</i> lines each contain an integer <i>b</i>(<i>v<sub>i</sub></i>) (1 &le; <i>b</i>(<i>v<sub>i</sub></i>) &le; 200), the balance of vertex <i>i</i>.</p></div></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>Output the weight of the found matching.</p></div><p class="pst">Sample Input</p><pre class="sio">4 3
3 1 6 4
3 1 10 4
2 3 2 2
2 1 6 6
2
2
4</pre><p class="pst">Sample Output</p><pre class="sio">12</pre><p class="pst">