</p><div class="ptx" lang="en-US"><div><p>A reset sequence is a series of commands which, when issued, brings a chip to the ready state. When a chip is powered on or encounters an error, it may be in an arbitrary state. The reset sequence ensures that the chip is appropriately (re-)initialized for subsequent tasks.</p><p>The state control of a chip is typically modeled after a finite automaton. (Please refer to <a href="problem?id=3599">Problem 3599 <i>Pumping Lemma</i></a> for an informal description of finite automata.) When it receives a command, the chip transits from its current state to another state as its control logic dictates.</p><p>Given the description of the control logic of a chip, compute the shortest reset sequence.</p></div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><div><p>The input consists of a single test case. The first line contains two integers <i>n</i> and <i>m</i> (2 &le; <i>n</i> &le; 8, 1 &le; <i>m</i> &le; 16), which are the numbers of states and different commands. The states are numbered 0 through <i>n</i> &minus; 1. State 0 is the <i>only</i> ready state. The commands are denoted by hexadecimal digits 0 through <i>f</i>.</p><p>Immediately following the first line comes an <i>n</i> × <i>m</i> matrix <i><b>&Delta;</b></i> = {<i>&delta;</i><sub><i>ij</i></sub>}<sub><i>n</i>×<i>m</i></sub> with zero-based indices. Each element <i>&delta;</i><sub><i>ij</i></sub> (0 &le; <i>&delta;</i><sub><i>ij</i></sub> &le; <i>n</i> &minus; 1) indicates that when the chip receives command <i>j</i> in state <i>i</i>, it transits to state <i>&delta;</i><sub><i>ij</i></sub> .</p></div></div><p class="pst">Output</p><div class="ptx" lang="en-US"><div><p>Output the shortest reset sequence using its representation by hexadecimal digits. If there are multiple such sequences, output any one. If there are no such sequences, output an asterisk (&ldquo;<tt>*</tt>&rdquo;).</p></div></div><p class="pst">Sample Input</p><pre class="sio">3 4
2 1 1 2
1 0 0 0
0 0 0 1</pre><p class="pst">Sample Output</p><pre class="sio">101</pre><p class="pst">