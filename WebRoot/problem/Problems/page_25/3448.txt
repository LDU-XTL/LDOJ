</p><div class="ptx" lang="en-US"><p>As any other marketing company, ACM produces a lot of funky advertising items that may contain a logo and be given to customers and business partners as small gifts. A unique specialty of ACM is a calculator that uses roman numbers.</p><p>Roman numbers are able to express any non-negative integer using uppercase letters:</p><table width="200" border="1" align="center"><tr><th scope="col"><div align="center">Letter</div></th><th scope="col"><div align="center">Value</div></th></tr><tr><td><div align="center">O</div></td><td><div align="center">0</div></td></tr><tr><td><div align="center">I</div></td><td><div align="center">1</div></td></tr><tr><td><div align="center">V</div></td><td><div align="center">5</div></td></tr><tr><td><div align="center">X</div></td><td><div align="center">10</div></td></tr><tr><td><div align="center">L</div></td><td><div align="center">50</div></td></tr><tr><td><div align="center">C</div></td><td><div align="center">100</div></td></tr><tr><td><div align="center">D</div></td><td><div align="center">500</div></td></tr><tr><td><div align="center">M</div></td><td><div align="center">1000</div></td></tr></table><p>Numbers are created by appending several letters together, the letter representing a higher value must always precede letters with lower values. The only exception are the letters “I”, “X”, and “C”, they may be used before higher letters to form values expressed by digits 4 and 9. The only possible combinations are:</p><table width="200" border="1" align="center"><tr><th scope="col"><div align="center">Pair of Letters</div></th><th scope="col"><div align="center">Value</div></th></tr><tr><td><div align="center">IV</div></td><td><div align="center">4</div></td></tr><tr><td><div align="center">IX</div></td><td><div align="center">9</div></td></tr><tr><td><div align="center">XL</div></td><td><div align="center">40</div></td></tr><tr><td><div align="center">XC</div></td><td><div align="center">90</div></td></tr><tr><td><div align="center">CD</div></td><td><div align="center">400</div></td></tr><tr><td><div align="center">CM</div></td><td><div align="center">900</div></td></tr></table><p>Any roman number must first express thousands, then hundreds, tens, and ones. Therefore, 499 must always be written as “CDXCIX”, not “ID”.</p><p>Although not very practical, this gift is considered extremely “cooooool”. Your task is to write software for that calculator.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>The input will consist from commands, each written on a separate line. Possible commands are  assignments, “RESET”, and “QUIT”.</p><p>An assignment command starts with a single digit representing one of ten registers that the calculator has. The register number is followed by an equal sign (“=”) and an expression. The expression will consist only from valid roman numbers, register names (digits), plus (“+”) and minus (“-”) signs. You may assume that the expression will always be valid and no longer than 10000 characters.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>For each command, output a single line. For assignments, print the register name, equal sign, and the value that is being assigned to that register. Instead of it, print the word “Error”, if the expression contains a reference to a register that has not been assigned before, or if the result is negative or larger than 10000. In such cases, no change to register values is made.</p><p> For RESET commands, invalidate all previous register assignments and print the word “Ready”.</p><p>The QUIT command will be the last one. Print the word “Bye” and terminate the program.</p></div><p class="pst">Sample Input</p><pre class="sio">1=MC+IV-X
1=1+1
RESET
1=1+X
1=MM
1=1+1+1+1+1
2=1+1
QUIT</pre><p class="pst">Sample Output</p><pre class="sio">1=MXCIV
1=MMCLXXXVIII
Ready
Error
1=MM
1=MMMMMMMMMM
Error
Bye</pre><p class="pst">