</p><div class="ptx" lang="en-US">Cows like to build shapes out of hay bales. Each new shape is constructed from N (1 <= N <= 25,000) 1 x 1 x 1 cubic bales.
<br>
<br>Bale 1 lies on the floor. After placing it, each successive bale from 2 through N is attached to the shape by placing the new bale in the proper relative position to one of the bales already placed.  For instance, imagine the following figure:
<br><blockquote>     Bale 1 - on the floor
<br>     Bale 2 - RIGHT Bale 1 (to Bale 1's right)
<br>     Bale 3 - FRONT Bale 2 (in front of Bale 2) 
<br>     Bale 4 - FRONT Bale 3</blockquote>
<br>This results in an (inverted) L-shape:
<br><pre>
<br>                     +--+--+                      
<br>                1-> /  /  /| <-2                      
<br>                   +--+--+ +
<br>                   | /  /|/                         
<br>                   ++--+ +                       
<br>                   /  /|/ <-3                     
<br>                  +--+ +                          
<br>                  |  |/ <-4                       
<br>                  +--+                            </pre>
<br>Adding another bale:
<br><blockquote>Bale 5 - OVER Bale 1</blockquote>
<br>adds height to the shape:
<br><pre>
<br>                     +--+                            
<br>                    /  /|                           
<br>                   +--+ +--+                      
<br>               5-> |  |/  /| <-2                      
<br>                   +--+--+ +
<br>               1-> | /  /|/                         
<br>                   ++--+ +                       
<br>                   /  /|/ <-3                     
<br>                  +--+ +                          
<br>                  |  |/ <-4                       
<br>                  +--+                            </pre>
<br>But adding another directive:
<br><blockquote>Bale 6 - BACK Bale 4</blockquote>
<br>results in an invalid shape, since bales 3 and 6 would overlap.
<br>
<br>Given N bales and placements described as above, output the exposed surface area of the solid figure if the shape is valid.  A face is considered exposed if it is not touched by any face of any other bale and does not touch the floor (i.e., is not the bottom of a cube on the floor).  Output -1 if the shape is invalid.  No bale will be placed farther than 25 bale-widths from the first bale.  No bale will be placed below the floor level.
<br>
<br></div><p class="pst">Input</p><div class="ptx" lang="en-US">* Line 1: A single integer, N
<br>
<br>* Lines 2..N: These lines describe the placement of bales 2..N in the form "j X". Line 2 describes bale 2; line 3 describes bale 3; and so on. The letter "X" is one of: "L" (left), "R" (right), "F" (front), "B" (back), "O" (over), or "U" (under). The bales can be glued and require no underlying support if extended over an empty space.
<br></div><p class="pst">Output</p><div class="ptx" lang="en-US">* Line 1: The exposed surface area of the resulting solid.  If the solid is invalid, output "-1".
<br></div><p class="pst">Sample Input</p><pre class="sio">5
1 R
2 F
3 F
1 O
</pre><p class="pst">Sample Output</p><pre class="sio">18
</pre><p class="pst">