</p><div class="ptx" lang="en-US"><p>A few years ago Nick learned set theory, and liked it so much that sets became the subject of his bachelor&#8217;s thesis. Nick&#8217;s thesis describes a new kind of mathematical equations &#8212; set equations. Set equations are composed of set variables, which represent various subsets of a universal set &#937;. The following four operations are defined for set variables:</p><ul><li><p>Intersection &#8745;: <i>A</i> &#8745; <i>B</i> := {<i>x</i> : <i>x</i> &#8712; <i>A</i> &#8743; <i>x</i> &#8712; <i>B</i>}</p></li><li><p>Union &#8746;: <i>A</i> &#8746; <i>B</i> := {<i>x</i> : <i>x</i> &#8712; <i>A</i> &#8744; <i>x</i> &#8712; <i>B</i>}</p></li><li><p>Difference &#8722;: <i>A</i> &#8722; <i>B</i> := {<i>x</i> : <i>x</i> &#8712; <i>A</i> &#8743; <i>x</i> &#8713; <i>B</i>}</p></li><li><p>Symmetric difference &#8853;: <i>A</i> &#8853; <i>B</i> := (<i>A</i> &#8722; <i>B</i>) &#8746; (<i>B</i> &#8722; <i>A</i>)</p></li></ul><p>The operations are listed in the order of their precedence, i.e. intersection has the highest precedence, union has lower precedence than intersection, difference has lower precedence than union, and symmetrical difference has the lowest precedence. Parentheses can be used to change operations precedence as usual.</p><p>The thesis includes a chapter dedicated to automated solving of some specific classes of set equations. Nick has already elaborated a notation for storing equations in text files. Here is some quotation from the thesis:</p><blockquote><p>The following notation is used for describing set equations:</p><table align="center" border="0"><tr><td align="right">&#8249;space or tab&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td><i>space</i> | <i>tabulation symbo</i>l</td></tr><tr><td align="right">&#8249;ws&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;space or tab&#8250; &#8727;</td></tr><tr><td align="right">&#8249;char&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8216;<tt>A</tt>&#8217; | &#8216;<tt>B</tt>&#8217; | &#8230; | &#8216;<tt>Z</tt>&#8217; | &#8216;<tt>a</tt>&#8217; | &#8216;<tt>b</tt>&#8217; | &#8230; | &#8216;<tt>z</tt>&#8217;</td></tr><tr><td align="right">&#8249;var&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;char&#8250; &#8249;char&#8250; &#8727;</td></tr><tr><td align="right">&#8249;expr&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;var&#8250;</td></tr><tr><td align="right"></td><td align="center" style="width: 2em">|</td><td>&#8249;expr&#8250; &#8249;ws&#8250; &#8249;operator&#8250; &#8249;ws&#8250; &#8249;expr&#8250;</td></tr><tr><td align="right"></td><td align="center" style="width: 2em">|</td><td>&#8216;<tt>(</tt>&#8217; &#8249;ws&#8250; &#8249;expr&#8250; &#8249;ws&#8250; &#8216;<tt>)</tt>&#8217;</td></tr><tr><td align="right">&#8249;operator&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8216;<tt>+</tt>&#8217; | &#8216;<tt>-</tt>&#8217; | &#8216;<tt>*</tt>&#8217; | &#8216;<tt>^</tt>&#8217;</td></tr><tr><td align="right">&#8249;equation&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;expr&#8250; &#8249;ws&#8250; &#8216;<tt>=</tt>&#8217; &#8249;ws&#8250; &#8249;expr&#8250;</td></tr></table><p>Operators &#8746;, &#8745;, &#8722; and &#8853; are encoded with tokens &#8216;<tt>+</tt>&#8217;, &#8216;<tt>*</tt>&#8217;, &#8216;<tt>-</tt>&#8217; and &#8216;<tt>^</tt>&#8217; respectively. The &#8216;<tt>=</tt>&#8217; token denotes the operator of set equality.</p><p>It is possible to assign values to some variable using the following notation:</p><table align="center" border="0"><tr><td align="right">&#8249;digit&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8216;<tt>0</tt>&#8217; | &#8216;<tt>1</tt>&#8217; | &#8230; | &#8216;<tt>9</tt>&#8217;</td></tr><tr><td align="right">&#8249;element&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;digit&#8250; &#8727;</td></tr><tr><td align="right">&#8249;variable value&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;var&#8250; &#8249;ws&#8250; &#8216;<tt>=</tt>&#8217; &#8249;ws&#8250; &#8249;values&#8250;</td></tr><tr><td align="right">&#8249;values&#8250;</td><td align="center" style="width: 2em">&#8594;</td><td>&#8249;element&#8250;</td></tr><tr><td>&nbsp;</td><td align="center" style="width: 2em">|</td><td>&#8249;element&#8250; &#8249;space or tab&#8250; &#8249;ws&#8250; &#8249;values&#8250;</td></tr></table></blockquote><p>Unfortunately Nick is not very skilled in programming so he asks you to help and write a program module for automated solving of one specific simple class of equations &#8212; the equations where each variable, except &#937;, occurs exactly one time.</p></div><p class="pst">Input</p><div class="ptx" lang="en-US"><p>Input file is written in Nick&#8217;s notation.</p><p>The first line of the input file contains an equation to solve. Total length of the equation does not exceed <nobr>1 000</nobr> characters. There is exactly one occurrence of each variable, except &#8220;<tt>Omega</tt>&#8221;, in the equation.</p><p>The following lines contain definitions of variable values. Variable name lengths do not exceed ten characters each. There is always a variable called &#8220;<tt>Omega</tt>&#8221; that represents the universal set. Both the number of elements in the universal set and the value of each element does not exceed 500.</p><p>The total length of all variable definitions does not exceed <nobr>100 000</nobr> characters.</p></div><p class="pst">Output</p><div class="ptx" lang="en-US"><p>First line of the output file must contain &#8220;<tt>Solution</tt>&#8221; if there exists at least one solution of the given equation and &#8220;<tt>No Solution</tt>&#8221; otherwise.</p><p>If the solution exists the following lines must contain such values of all undefined variables so that equation is satisfied. The variables may be listed in arbitrary order.</p></div><p class="pst">Sample Input</p><pre class="sio"><table border="1" style="border-collapse: collapse" bordercolor="#000000" id="table1"><tr><th>#1</th><td>Omega - OneOrThree = Two<br>Omega = 1 2 3<br>Two = 2</td></tr><tr><th>#2</th><td>Omega * result * result = Empty<br>Omega = 1 2 3 4 5<br>Empty =</td></tr><tr><th>#3</th><td>(one+two) ^(TWO+three) = result<br>one&nbsp; =1<br>TWO&nbsp; =1 3 4 5<br>two&nbsp; =2<br>three=3<br>Omega=1 2 3 4 5<br>result = 2 3 4 5</td></tr><tr><th>#4</th><td>Omega ^Omega = Omega<br>Omega=123 234 345 456</td></tr></table></pre><p class="pst">Sample Output</p><pre class="sio"><table border="1" style="border-collapse: collapse" bordercolor="#000000" id="table1"><tr><th>#1</th><td>Solution<br>OneOrThree = 1 3</td></tr><tr><th>#2</th><td>Solution<br>Result=</td></tr><tr><th>#3</th><td>Solution</td></tr><tr><th>#4</th><td>No Solution</td></tr></table></pre><p class="pst">