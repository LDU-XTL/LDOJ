</p><div class="ptx" lang="en-US"><div>Today is the birthday of Mr. Bon Vivant, who is known as one of the greatest <i>p&acirc;tissiers</i> in the world. Those who are invited to his birthday party are <i>gourmets</i> from around the world. They are eager to see and eat his extremely creative cakes. Now a large box-shaped cake is being carried into the party. It is not beautifully decorated and looks rather simple, but it must be delicious beyond anyone's imagination. Let us cut it into pieces with a knife and serve them to the guests attending the party. <!-- end en only --><!-- begin en only --><p>The cake looks rectangular, viewing from above (Figure C-1). As exemplified in Figure C-2, the cake will iteratively be cut into pieces, where on each cut exactly a single piece is cut into two smaller pieces. Each cut surface must be orthogonal to the bottom face and must be orthogonal or parallel to a side face. So, every piece shall be rectangular looking from above and every side face vertical. </p><!-- end en only --><center><img src="images/3327_1.png"><br><br><!-- begin en only -->Figure C-1: The top view of the cake <!-- end en only --></center><center><br><img src="images/3327_2.png"><br><br><!-- begin en only -->Figure C-2: Cutting the cake into pieces <!-- end en only --></center><!-- begin en only --><p>Piece sizes in Figure C-2 vary significantly and it may look unfair, but you don't have to worry. Those guests who would like to eat as many sorts of cakes as possible often prefer smaller pieces. Of course, some prefer larger ones. </p><!-- end en only --><!-- begin en only -->Your mission of this problem is to write a computer program that simulates the cutting process of the cake and reports the size of each piece. </div></div><p class="pst">Input</p><div class="ptx" lang="en-US"><div><!-- begin en only --><p>The input is a sequence of datasets, each of which is of the following format. </p><!-- end en only --><blockquote><i>n</i>&nbsp;&nbsp;<i>w</i>&nbsp;&nbsp;<i>d</i><br><i>p</i><sub>1</sub>&nbsp;&nbsp;<i>s</i><sub>1</sub><br>...<br><i>p<sub>n</sub></i>&nbsp;&nbsp;<i>s<sub>n</sub></i><br>ã€€</blockquote><!-- begin en only --><p>The first line starts with an integer <i>n</i> that is between 0 and 100 inclusive. It is the number of cuts to be performed. The following <i>w</i> and <i>d</i> in the same line are integers between 1 and 100 inclusive. They denote the width and depth of the cake, respectively. Assume in the sequel that the cake is placed so that <i>w</i> and <i>d</i> are the lengths in the east-west and north-south directions, respectively. </p><!-- end en only --><!-- begin en only --><p>Each of the following <i>n</i> lines specifies a single cut, cutting one and only one piece into two. <i>p<sub>i</sub></i> is an integer between 1 and <i>i</i> inclusive and is the identification number of the piece that is the target of the <i>i</i>-th cut. Note that, just before the <i>i</i>-th cut, there exist exactly <i>i</i> pieces. Each piece in this stage has a unique identification number that is one of 1, 2, ..., <i>i</i> and is defined as follows: </p><!-- end en only --><!-- begin en only --><ul><li>The earlier a piece was born, the smaller its identification number is. </li><li>Of the two pieces born at a time by the same cut, the piece with the smaller area (looking from above) has the smaller identification number. If their areas are the same, you may define as you like the order between them, since your choice in this case has no influence on the final answer. </li></ul><!-- end en only --><!-- begin en only --><p>Note that identification numbers are adjusted after each cut. </p><!-- end en only --><!-- begin en only --><i>s<sub>i</sub></i> is an integer between 1 and 1000 inclusive and specifies the starting point of the <i>i</i>-th cut. From the northwest corner of the piece whose identification number is <i>p<sub>i</sub></i>, you can reach the starting point by traveling <i>s<sub>i</sub></i> in the clockwise direction around the piece. You may assume that the starting point determined in this way cannot be any one of the four corners of the piece. The <i>i</i>-th cut surface is orthogonal to the side face on which the starting point exists. <!-- end en only --><!-- begin en only --><p>The end of the input is indicated by a line with three zeros. </p><!-- end en only --></div></div><p class="pst">Output</p><div class="ptx" lang="en-US"><div><!-- begin en only --><p>For each dataset, print in a line the areas looking from above of all the pieces that exist upon completion of the <i>n</i> cuts specified in the dataset. They should be in ascending order and separated by a space. When multiple pieces have the same area, print it as many times as the number of the pieces. </div></div><p class="pst">Sample Input</p><pre class="sio">3 5 6
1 18
2 19
1 2
3 4 1
1 1
2 1
3 1
0 2 5
0 0 0</pre><p class="pst">Sample Output</p><pre class="sio">4 4 6 16
1 1 1 1
10</pre><p class="pst">